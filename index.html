<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>RSNGMN</title>
<link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAYAAACI7Fo9AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAUGVYSWZNTQAqAAAACAACARIAAwAAAAEAAQAAh2kABAAAAAEAAAAmAAAAAAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAD6oAMABAAAAAEAAAD6AAAAAL+pwy0AAAIyaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4yNTA8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjI1MDwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpBAicdAAAQsElEQVR4Ae2dz4sdxxHHV6s48i2QgxwI1k3GRCiQq0luIocFH4TA8cX/RjDkkByNrrnkP4hsED4IcjJGkJBrwMLCRAQS+RIUyDFYCrtK1Wonfm+2376e6R9V3f0ZaD1Nv57urk/39/VMbc3MwQEbBCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEFhO4tPgIDlhF4KVsqw5MPOiSbPMqcvcl1Ma8TfZtCRzaNk/rEIBADQIIvQZl2oCAMQGEXmcALDnP257v1yFAK6YEGPTy+JXxUflmdragbU/jbN2XnZ3ki7IEzjlqyjY3Ru3i7Loult6XdEPSJLIxjM9gJc69DBBnVSD0GZAcuyL0L6SemznqGrEOhJ5/1BF6fqYHIvRjqZaVfCVbhL4S3AWHMRkvgLPyK/3xhOtKeGeHwS+N37mjAXoOyeoMFfh3Jb23ugYOnAhsOhCnPD4TCCD0BfDklPyapHuSnkr6RtLmdiI7zyXdW1AlRQMEhOEDScdn6Qv5VOfmuU3zJen3L84+g+XOHThgBtfoCwZdJtNfpTiTaQGzTEUfyXX7j+d1qbglb9PpGSw3P27EfYS+YNRlYpnEqy/oYq9FT0Tol+fGyXDMnZ7BcvPjRtzn1D1+1PlRjGeVu6TO0/lcjc3L3Zcm65vDa9KIwp3GyVYYcGT1mw46nbe7og03y0VW3X8xVikZYzkFvCYfdyW9I+mqpCuS2NomcCLd/1LSHTntf9K2Kem9R+jCUISOky19LnmtAQedjAxCfyV0nGxeZZreLxx0wpBrdH7s0qXku4aQ0853jwv0bmSh42QrMKGcVjm8g67rU3ecbE5lZ9etYR10vQsdJ5udqDy3PJyDrneh42TzLDe7vg3noOv5Gr1n2+wk0kfLOje6XuTmw9SrGNSuXZFTcwbsj0lAbyfW24qHEHw3Rorjjee0jSnY3FY/lwqfSfqTpA8lqu5p7gYs6utJ6PNbFi140mZfBJ6I0N/qwaSehD6/ZbGH8cEGYwIi9C400ss1utrRiy3GU5vmZwS6mFc9GKE24HibzU52sxHoIqquydMSHG/ZJjEVxRNoOqquVaHjeIufoJTMS6DJqLpWhY7jLe/kpbZ4Ak1G1bV4ja59brHf8VOJkp4JNDn/WhOM9hfHm2cZjNG35hx07k/dz241/UzmD89TH0NELVnZjIOuBaHrm09+0dLo09fhCLh30LUg9Kcybd4cbupgcEsE3DvoWhD6NzLiPH65pWk/YF8lUlbfJKOn8i63FpxxiNzl1KFTMwKuHXQtrOg8JWY2o9h1T0BfGHFLVnm97HSxtbCiuwBFJyCwgID+heijBeWLF/UudPdnHMVHiAZaJaCv93KzeRf6a25I0REILCPwg2XFy5b2LHRdzW+XNZ/aIVCMgCsn8neKmbmiYqLgVkDjEAhEEPC2ot+VPhPqGjFwFIHAEgLehO7KgbEEJGUhECDgxpnsTehXA7DIgkCrBNw4k70J3ZUDo9XZRb/dEFBnsotV3UUnpmERZxxRcBMMPnsjYBot521F721wsQcCEwHTaDlPQnd1djGNDp8QyEjAzNnsSehuHBcZB5aqILBJwCxazkvAjK7mRMFtTgn+3yOBK8fHx7+ZDDs8PHwod7g9nPZLfpoJXfxub4hhf5REgEzJEaZuVwRE3L+eOnRycvqciofTfslPy1P3X4lhiLzk6FI3BM4IWAr9p4wCBCBQh4Cl0H9Yx0RagQAELIX+PfBDAAJ1CJj97Vqccbw/rc4Y04pTAqKBf4vX/Sc1ni1nuaJbtu106OnWSARE4N8Xe6s8Ww6xjTSzsNUjgSrRcpan7tzA4nHa0afaBJ7Lyv566UZZ0UsTpn4IXEygyq3ZCP3iQeBbCHRBwEroZpcMXYwaRkBgIQGEvhAYxSFQgEDxhc9K6MWdDwUGgyohUIpA8Vu0LYSuv14flCJGvRBokEDxZ8sVP2VQ6I/lLjX5W9p9+e8NSac/Lj/i8XCKhg0CQQLyJ7es2qxyP/qZyG8GLSITAhAoTqDWqbuu5GwQgIARgRpC1zZqtGOEkGYh4J9AaQFq/Uf+MdBDCPRNIPs1+qODgzdE3TwLru95g3WNEci+okuFPAuusUlAd/snkF3ogoxnwfU/b7CwMQLZhS5/SuNZcI1NArrbP4HsQpe/8vMsuP7nDRY2RiC7M07sPxe3SxRcY7OC7nZHIPuKLoRK1NkdeAyCQE0CiLImbdqCgBEBhG4EnmYhUJMAQq9Jm7YgYEQAoRuBp1kI1CSQW+hZ76GtCYK2INAzAYTe8+hiGwTOCOQWOs+CY2pBwCGBnELX03aeBedwkOkSBJIi4748OOC1SswhCDRAIOeK3oC5dBECYxJA6GOOO1YPRgChDzbgmDsmAYQ+5rhj9WAEkgJcUpxx3Lo62EzD3BQCT+TgW/JOh6drK2FFX0uO4yBQj8B1aeqjlOYQego9joVAPQJJz2JE6PUGipYgkELgasrBCD2FHsdCoB6BKylNIfQUehwLgUYIIPRGBopuQiCFAEJPocexEKhLYPWfwxF63YGiNQikEDj3KPXYyhB6LCnKQcCewG3pwqpVHaHbDx49gEAUgZcvX96TdCLpWNIXkjSQJmpD6FGYKAQBVwRUtzcl3Y/tFUKPJUU5CPgj8HZslxB6LCnKQcAfga9iu5T0KKnYRigHAQhkJXAitcnNowd3Ymtd5cHbUbmeHRxJ6w92fL+VzW2qWzjYgcBeAnKb6vtS6BNJi5/VmFPo2tFDEfqx/mffhtD3EeJ7CGwTEKFrvPuL7dy4vdzX6HpKwQYBCJQh8N+11eYWeu761trFcRDokcDiU/YJQk5hal1HU8V8QgACfggkXaPL9fg1MeUzSdEROheZznX7RXT4bnQCco2+Wq+pK/pdgZ9F5KMPIvZDoCSBVKG/U7Jz1A0BCGwRMFvRk55jtWUCOxCAwD4CZrepJj3Hap9VfA8BCGwR6OM21cfia9hM/7qrLgA2CEBACchtqWa3qT5nCCAAgeoE1LdW9TbVZ9VNpEEIQGAiUO021T9PLfIJAQhUJxB9m2rqn9d+KabpC+DYIACBegT0npJHkqJvU026H/3GwcFTaeytM/v0b3zvSbTcvbN9PiAAgYwEJDDuXanuD5IW3zyWuqJvmqEB959uZqT+/z+ff55aBcdDoCcCq0SuAFZH2uygd0lW9MW/NjvqOs0m/v0iOnw3EIETWdEvr7U354qufVh9G91aAzgOAoMQkDV0/ZZ0jb6+WY6EAAQiCegZsoo82vEWqteV0DlNDw0ReSMSSLklNcQr96m7tkG0XIg0eRAwJFBC6ETLGQ4oTUMgRKCE0ImWC5EmDwKGBEoInWg5wwGlaQiECOT+O/q8jSLRcjjt5pjZ741AC864TebZo+U2K+f/EIBAHIESp+7zllc/dH5eEfsQgMA6AjWETrTcurHhKAhkI1BD6Nk6S0XbBOQ6bjuj4F7NtgqaMWzVriLjQqOA4y1EhTwILCNQa0UnWm7ZuESVlocFRpXLUahmWzn6Sx3bBGoJnWi5be7sQaAqgVpCJ1qu6rDSGAS2CdQSOtFy29zZg0BVAvXctt+alRwth4PuW5j8r08CrUXGhUaBaLkQFfIgUJBArVP3uQlEy82JsA+BggSshF7v70IF4VE1BFohYCX0VvjQTwh0QQChdzGMGNEyAXG8vSvpsjrgpi23PZZCJ1ou92hSX6sEVr+YIdZgS6ETLRc7SpTrmYA+zjnrS09CsCyFTrRcaETIG41A0osZYmFZCp1oudhRolyPBHQVX/RG1BQIFpFxof7qD86R/LQ9CH25No8IurXkOK4UAXG2rX4jakqfvAhdbTgUoR+nGDM/FqHPibBvTUCEri9KLH5NPrfT8tR93pfqxs87wD4EKhAwmeeehO6pLxXGmyYGJWAyz00aDQyw9uMokE8WBHojoPO8uu7MrtEfHxxcl4D3+2L0jVKGc43em0a6skdP4U9fhyzX7U9KW1b9l2Uy6EzkN2XfrA9TX/iEgAEBnfc6/3WxK75Ziuzt4tbRAAT8E6iiA0uh/93/GNBDCBQn8FXxFqQBS6HfkvY/lvS1JG5wEQhsQxHQa/ThIuN2jrB4K4o/pAKn3U78fJGZgFVknOWKnhkh1UGgCQLFb0kNUUDoISrkQaAMAT1dHz4yrgxaaoWAHwL6d3OTzf1LFk2o0CgE8hL4f3BM3mrja0Po8awoCYFFBKwcb6FOco0eokIeBPIQMHG8hbqO0ENUyINAOgEzx1uo6wg9RIU8CKQTMHO8hbrONXqICnkQWE/A3PEW6rrZbaqhzoTyakTGhdoN5RFBF6JCnhIQx9v78vGJpOKRnNre0o1T96XEKA+BMIFPJdulyLW7CD08aORCYCkB128IRuhLh5PyEAgTcLuaa3cRenjQyIVAVwTcO+P20Nb+vybptjjt7u0pW+RrHHRFsDZXqTjjXGup9RVdT5deSFJvJxsErAi4f3BK60KfBlYFb3L739QBPocm8E/v1vcidOXsKhLJ+8DTv6wE3L8ZuBuhywXSHRk6fQYXK3vWOUxlewjoM9k/3FPG/GvXDoQEOvoDlv3trLH9wUEXS6rNcp5uP40l2KvQ1f7sb2eNhYrQY0m1WU6EbvJG1BRa3Zy6ByC4uk0w0D+y2iTQ5LzqWeg6jXDQtSkmz71uck51LXQcdJ710lzfdCWv9sKF3HR6vkafs3LnoHscCKbi+n4+bLb7LTreQsS6XtFnBusvsj7Diw0CSwi4ee7bkk7Py44kdLW9SUfKfNDYr0agm/kymtB1hjTpTKk2tWlok4AGw3SxDSd0HHRdzNuSRugNKv+Q9HtJPy/ZUM26R3LGhbjqD51ZBF2oQ6E8HHQhKml54mTTZ7zp45/0yTCuHxqRZumro0cXulIwi6CLHUCEHksqvpwIXX/kuxf4RGS4U/fJ8I3PbhwuGzbx34sJ6JgPI3JFgdBfTQgcdK84jPLvcOON0GVq46AbRd+nf15tNrotZZS4Rj9PT3/8cNCd59JsTi/RbSkDgNDD9HDQhbk0mStCb+620tygOXUPE1VnDVsfBHC2yjgi9N2TuZuoqN0mDvHNcI630Kgi9BAVyZNl4Gfy8VtJf5G/wzyTT42YYqUXCI1sOlZDOt5C48M1eojK8jzlqOl1SR/IEvK75VXUO6LnABwcb+F5hNDDXFJyL4nQXa/8nQt9eMdbaPJy6h6ikpY3VMRVGqrsR+sPrOsf2ewWR1aI0CNBLSyGI28hsEzF/5apnu6qQegFhlSWFBx5BbjuqHLzttJbO8oMn801uv0UaMqRF4srtx9AnGxD3VYayzm2HEKPJVWnnHtHXiyGAkLXs0/8H7EDMCvHqfsMiPEuE3n3AMBmN5u93yD0vYgoAIH2CSD09scQCyCwlwDX6HsRjVFAgnyiTo1vvIoAHANKR1ayonc0mJgCgV0EEPouMuSHCBB1FqLSQB5Cb2CQKnUxJpqPyLNKg5G7GYSem2i79WlU2ceSvpak0WbTdhp5Js4cfaEBkWcTFT4hAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCDQP4H/AavEgMvINm3mAAAAAElFTkSuQmCC" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family:'Roboto',sans-serif;background:#000;color:#fff;margin:0;display:flex;flex-direction:column;height:100vh; }
    header { padding:12px 16px;border-bottom:1px solid #444;font-weight:700;text-transform:uppercase;letter-spacing:2px; }
    main { flex:1;display:flex;flex-direction:column; }
    #messages { flex:1;overflow-y:auto;padding:16px; }
    .msg { margin-bottom:10px;max-width:70%;padding:8px 12px;border-radius:6px;line-height:1.4;font-size:14px;background:#111; }
    .mine { background:#fff;color:#000;margin-left:auto; }
    .meta { font-size:11px;opacity:0.6;margin-bottom:2px; }
    .controls { border-top:1px solid #444;display:flex;gap:8px;padding:10px;background:#000; }
    input,button { font-family:'Roboto',sans-serif;font-size:14px;padding:8px;border:none;outline:none; }
    input { flex:1;background:#111;color:#fff; }
    button { background:#fff;color:#000;cursor:pointer;font-weight:500; }
    button:hover{ background:#ccc; }
    #status { font-size:12px;opacity:0.7;padding:4px 10px;border-top:1px solid #444; }
    #adminTools { border-top:1px solid #444;padding:8px 10px;font-size:12px;display:none; }
    #adminTools button { background:#111;color:#fff;border:1px solid #444;padding:6px 8px;font-size:12px; }
    #joinBox { border-top:1px solid #444;padding:8px 10px;display:none; }
    #joinBox input { background:#111;color:#fff;width:70%;margin-right:8px; }
    #joinBox button { background:#111;color:#fff;border:1px solid #444;font-size:12px; }
  </style>
</head>
<body>
  <header>RSNGMN Chat</header>

  <main>
    <div id="messages"></div>
    <div class="controls">
      <input id="textInput" placeholder="Message..." />
      <button id="sendBtn">Send</button>
    </div>
    <div id="adminTools">
      <button id="exportKeyBtn">Export Room Key</button>
      <button id="revokeBtn">Revoke Key</button>
    </div>
    <div id="joinBox">
      <input id="pasteKey" placeholder="Paste key here" />
      <button id="joinBtn">Join</button>
    </div>
    <div id="status">Connectingâ€¦</div>
  </main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-app.js";
import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-auth.js";
import { getFirestore, collection, doc, setDoc, getDoc, addDoc, onSnapshot, orderBy, query, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-firestore.js";

// Your Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyCquKmonZI6sXLCIzl8BVz_QayGZK6yY9A",
  authDomain: "rsngmn-6da62.firebaseapp.com",
  projectId: "rsngmn-6da62",
  storageBucket: "rsngmn-6da62.firebasestorage.app", // FIXED STORAGE BUCKET
  messagingSenderId: "1045190357466",
  appId: "1:1045190357466:web:100a639d820269fce6d0e3"
};

// Init
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* Cookie utils */
function setCookie(name,value,days=365){
  const ex=new Date(Date.now()+days*864e5).toUTCString();
  document.cookie=`${name}=${encodeURIComponent(value)};expires=${ex};path=/;SameSite=Lax`;
}
function getCookie(name){
  const v=document.cookie.split('; ').find(r=>r.startsWith(name+'='));
  return v?decodeURIComponent(v.split('=')[1]):null;
}

/* Crypto helpers */
const enc=new TextEncoder(),dec=new TextDecoder();
async function genKey(){return crypto.subtle.generateKey({name:"AES-GCM",length:256},true,["encrypt","decrypt"]);}
async function expKey(k){
  const raw=await crypto.subtle.exportKey("raw",k);
  return btoa(String.fromCharCode(...new Uint8Array(raw)));
}
async function impKey(b64){
  const bin=atob(b64),buf=new Uint8Array(bin.length);
  for(let i=0;i<bin.length;i++)buf[i]=bin.charCodeAt(i);
  return crypto.subtle.importKey("raw",buf.buffer,"AES-GCM",true,["encrypt","decrypt"]);
}
function randIv(){return crypto.getRandomValues(new Uint8Array(12));}
async function encryptText(txt,key){
  const iv=randIv();
  const ct=await crypto.subtle.encrypt({name:"AES-GCM",iv},key,enc.encode(txt));
  return {
    cipher: btoa(String.fromCharCode(...new Uint8Array(ct))),
    iv: btoa(String.fromCharCode(...iv))
  };
}
async function decryptText(ciph,ivB64,key){
  try{
    const ct=Uint8Array.from(atob(ciph),c=>c.charCodeAt(0)).buffer;
    const iv=Uint8Array.from(atob(ivB64),c=>c.charCodeAt(0));
    const pt=await crypto.subtle.decrypt({name:"AES-GCM",iv},key,ct);
    return dec.decode(pt);
  }catch(e){
    return null;
  }
}

/* UI */
const sendBtn=document.getElementById('sendBtn');
const textInput=document.getElementById('textInput');
const messagesDiv=document.getElementById('messages');
const status=document.getElementById('status');
const adminTools=document.getElementById('adminTools');
const exportKeyBtn=document.getElementById('exportKeyBtn');
const revokeBtn=document.getElementById('revokeBtn');
const joinBox=document.getElementById('joinBox');
const pasteKey=document.getElementById('pasteKey');
const joinBtn=document.getElementById('joinBtn');

let myUid=null;
let key=null;
let isAdmin=false;

/* Auth */
onAuthStateChanged(auth,user=>{
  if(user){
    myUid=user.uid; 
    status.innerText = "Authenticated. Loading roomâ€¦";
    init();
  }
  else signInAnonymously(auth);
});

async function init(){
  let b64=getCookie("rsngmn_key");
  const metaDoc = doc(db,"meta","room");
  const snap = await getDoc(metaDoc);

  if(!b64){
    if(!snap.exists()){
      // First visitor becomes admin
      key=await genKey();
      b64=await expKey(key);
      setCookie("rsngmn_key",b64);
      await setDoc(metaDoc,{admin:myUid,createdAt:Date.now()});
      isAdmin=true;
      status.innerText = "You are admin. Room created.";
    }else{
      // Show join box
      joinBox.style.display="block";
      status.innerText = "Room exists. Paste key to join.";
      return;
    }
  }else{
    key=await impKey(b64);
    if(snap.exists() && snap.data().admin===myUid){
      isAdmin=true;
      status.innerText = "You are admin.";
    }else{
      status.innerText = "Joined as guest.";
    }
  }

  if(isAdmin){ adminTools.style.display="block"; }
  listen();
}

/* Join flow */
joinBtn.onclick=async()=>{
  const pasted=pasteKey.value.trim();
  if(!pasted)return alert("Paste a key first");
  try{
    await impKey(pasted); // just test it
    setCookie("rsngmn_key",pasted);
    location.reload();
  }catch(e){
    alert("Invalid key format");
  }
};

/* Send */
sendBtn.onclick=async()=>{
  const txt=textInput.value.trim();if(!txt||!key)return;
  try {
    const {cipher,iv}=await encryptText(txt,key);
    await addDoc(collection(db,"rooms","rsngmn","messages"),{
      senderId:myUid,cipher,iv,
      createdAt:serverTimestamp()
    });
    textInput.value="";
    status.innerText = "Message sent.";
  } catch (e) {
    status.innerText = "Failed to send message.";
  }
};

// Allow Enter key to send
textInput.addEventListener('keypress',e=>{
  if(e.key==="Enter") sendBtn.onclick();
});

/* Listen */
function listen(){
  const q=query(collection(db,"rooms","rsngmn","messages"),orderBy("createdAt","asc"));
  onSnapshot(q,async snap=>{
    messagesDiv.innerHTML="";
    for(const docSnap of snap.docs){
      const d=docSnap.data();
      let msg="<i>locked</i>";
      if(key){
        const plain=await decryptText(d.cipher,d.iv,key);
        if(plain!==null)msg=escapeHtml(plain);
      }
      const wrap=document.createElement("div");
      wrap.className="msg"+(d.senderId===myUid?" mine":"");
      wrap.innerHTML=`<div class="meta">${d.senderId.slice(0,6)}</div><div>${msg}</div>`;
      messagesDiv.appendChild(wrap);
    }
    messagesDiv.scrollTop=messagesDiv.scrollHeight;
  });
}

/* Admin */
exportKeyBtn.onclick=()=>{
  const b64=getCookie("rsngmn_key");
  if(!b64)return alert("No key cookie.");
  prompt("Copy room key:",b64);
};
revokeBtn.onclick=()=>{
  document.cookie="rsngmn_key=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;";
  location.reload();
};

function escapeHtml(t){return t.replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"}[m]));}
</script>
</body>
</html>
